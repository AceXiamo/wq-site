var r=Object.defineProperty;var h=(t,e,a)=>e in t?r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var i=(t,e,a)=>(h(t,typeof e!="symbol"?e+"":e,a),a);import{D as v,r as o}from"./entry.d366c4b7.js";class c{constructor(){i(this,"audio",null);i(this,"timeUpdate",null);i(this,"onPause",null);i(this,"onPlay",null);i(this,"onEnd",null);i(this,"onTimeUpdate",e=>{const{currentTime:a,duration:u}=this.audio||{};this.timeUpdate&&this.timeUpdate(a||0,u||0)})}init(e){this.audio||(this.audio=document.createElement("audio")),this.audio.src=e,this.audio&&this.audio.addEventListener("timeupdate",this.onTimeUpdate),this.audio.oncanplay=()=>{this.audio&&this.audio.play()}}play(){this.audio&&this.audio.play(),this.onPlay&&this.onPlay()}pause(){this.audio&&this.audio.pause(),this.onPause&&this.onPause()}destroy(){this.audio&&this.audio.removeEventListener("timeupdate",this.onTimeUpdate),this.audio&&this.audio.pause(),this.audio=null}}const U=["repeat","repeat-one","shuffle"],P=v("musics",()=>{const t=o([]),e=o(null),a=new c,u=o("repeat"),n=(s,l)=>{e.value.progress=s/l*100,e.value.duration=l-s,l>0&&e.value.duration<=0&&d(p())},p=()=>{if(u.value==="repeat"){let s=t.value.indexOf(e.value);t.value[s+1]||t.value[0]}else if(u.value==="shuffle"){let s=Math.floor(Math.random()*t.value.length);t.value[s]}else e.value},d=s=>{t.value.forEach(l=>{l.play=!1}),e.value=s,e.value.duration=0,e.value.pause=!1,e.value.progress=0,a.init(e.value.mid),a.timeUpdate=n,a.onPause=()=>{e.value.pause=!0},a.onPlay=()=>{e.value.pause=!1}};return{musics:t,current:e,timeUpdate:n,play:d,player:a,pauseHandle:()=>{e.value.pause?a.play():a.pause()},playStatus:u}});export{U as M,P as u};
